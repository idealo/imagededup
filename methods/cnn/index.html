
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
        <meta name="author" content="idealo Data Science Team">
      
      
      
        <link rel="prev" href="../../user_guide/benchmarks/">
      
      
        <link rel="next" href="../hashing/">
      
      
      <link rel="icon" href="../../img/favicon.ico">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.14">
    
    
      
        <title>CNN - Imagededup</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.342714a4.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#class-cnn" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="Imagededup" class="md-header__button md-logo" aria-label="Imagededup" data-md-component="logo">
      
  <img src="../../img/logo.svg" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Imagededup
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              CNN
            
          </span>
        </div>
      </div>
    </div>
    
      
    
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/idealo/imagededup" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    idealo/imagededup
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Imagededup" class="md-nav__button md-logo" aria-label="Imagededup" data-md-component="logo">
      
  <img src="../../img/logo.svg" alt="logo">

    </a>
    Imagededup
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/idealo/imagededup" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    idealo/imagededup
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Home
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    User Guide
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            User Guide
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../user_guide/finding_duplicates/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Finding duplicates
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../user_guide/encoding_generation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Encoding generation
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../user_guide/custom_model/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Custom Models
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../user_guide/plotting_duplicates/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Plotting duplicates
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../user_guide/evaluating_performance/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Evaluating performance
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../user_guide/benchmarks/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Benchmarks
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" checked>
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    API reference
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            API reference
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_1" checked>
        
          
          <label class="md-nav__link" for="__nav_3_1" id="__nav_3_1_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Methods
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_1_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3_1">
            <span class="md-nav__icon md-icon"></span>
            Methods
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    CNN
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    CNN
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#class-cnn" class="md-nav__link">
    <span class="md-ellipsis">
      class CNN
    </span>
  </a>
  
    <nav class="md-nav" aria-label="class CNN">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
    <nav class="md-nav" aria-label="__init__">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#args" class="md-nav__link">
    <span class="md-ellipsis">
      Args
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#apply_preprocess" class="md-nav__link">
    <span class="md-ellipsis">
      apply_preprocess
    </span>
  </a>
  
    <nav class="md-nav" aria-label="apply_preprocess">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#args_1" class="md-nav__link">
    <span class="md-ellipsis">
      Args
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#encode_image" class="md-nav__link">
    <span class="md-ellipsis">
      encode_image
    </span>
  </a>
  
    <nav class="md-nav" aria-label="encode_image">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#args_2" class="md-nav__link">
    <span class="md-ellipsis">
      Args
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#returns_1" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#example-usage" class="md-nav__link">
    <span class="md-ellipsis">
      Example usage
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#encode_images" class="md-nav__link">
    <span class="md-ellipsis">
      encode_images
    </span>
  </a>
  
    <nav class="md-nav" aria-label="encode_images">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#args_3" class="md-nav__link">
    <span class="md-ellipsis">
      Args
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#returns_2" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#example-usage_1" class="md-nav__link">
    <span class="md-ellipsis">
      Example usage
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#find_duplicates" class="md-nav__link">
    <span class="md-ellipsis">
      find_duplicates
    </span>
  </a>
  
    <nav class="md-nav" aria-label="find_duplicates">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#args_4" class="md-nav__link">
    <span class="md-ellipsis">
      Args
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#returns_3" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#example-usage_2" class="md-nav__link">
    <span class="md-ellipsis">
      Example usage
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#find_duplicates_to_remove" class="md-nav__link">
    <span class="md-ellipsis">
      find_duplicates_to_remove
    </span>
  </a>
  
    <nav class="md-nav" aria-label="find_duplicates_to_remove">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#args_5" class="md-nav__link">
    <span class="md-ellipsis">
      Args
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#returns_4" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#example-usage_3" class="md-nav__link">
    <span class="md-ellipsis">
      Example usage
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../hashing/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Hashing
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_2" >
        
          
          <label class="md-nav__link" for="__nav_3_2" id="__nav_3_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Evaluation
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_2">
            <span class="md-nav__icon md-icon"></span>
            Evaluation
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../evaluation/evaluation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Evaluation
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_3" >
        
          
          <label class="md-nav__link" for="__nav_3_3" id="__nav_3_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Utils
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_3">
            <span class="md-nav__icon md-icon"></span>
            Utils
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../utils/plotter/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Plot duplicates
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../utils/models/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Custom Models
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Example
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Example
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../examples/CIFAR10_deduplication/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    CIFAR10 deduplication
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../CONTRIBUTING/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Contribution
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../LICENSE/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    License
    
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#class-cnn" class="md-nav__link">
    <span class="md-ellipsis">
      class CNN
    </span>
  </a>
  
    <nav class="md-nav" aria-label="class CNN">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
    <nav class="md-nav" aria-label="__init__">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#args" class="md-nav__link">
    <span class="md-ellipsis">
      Args
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#apply_preprocess" class="md-nav__link">
    <span class="md-ellipsis">
      apply_preprocess
    </span>
  </a>
  
    <nav class="md-nav" aria-label="apply_preprocess">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#args_1" class="md-nav__link">
    <span class="md-ellipsis">
      Args
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#encode_image" class="md-nav__link">
    <span class="md-ellipsis">
      encode_image
    </span>
  </a>
  
    <nav class="md-nav" aria-label="encode_image">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#args_2" class="md-nav__link">
    <span class="md-ellipsis">
      Args
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#returns_1" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#example-usage" class="md-nav__link">
    <span class="md-ellipsis">
      Example usage
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#encode_images" class="md-nav__link">
    <span class="md-ellipsis">
      encode_images
    </span>
  </a>
  
    <nav class="md-nav" aria-label="encode_images">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#args_3" class="md-nav__link">
    <span class="md-ellipsis">
      Args
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#returns_2" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#example-usage_1" class="md-nav__link">
    <span class="md-ellipsis">
      Example usage
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#find_duplicates" class="md-nav__link">
    <span class="md-ellipsis">
      find_duplicates
    </span>
  </a>
  
    <nav class="md-nav" aria-label="find_duplicates">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#args_4" class="md-nav__link">
    <span class="md-ellipsis">
      Args
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#returns_3" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#example-usage_2" class="md-nav__link">
    <span class="md-ellipsis">
      Example usage
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#find_duplicates_to_remove" class="md-nav__link">
    <span class="md-ellipsis">
      find_duplicates_to_remove
    </span>
  </a>
  
    <nav class="md-nav" aria-label="find_duplicates_to_remove">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#args_5" class="md-nav__link">
    <span class="md-ellipsis">
      Args
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#returns_4" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#example-usage_3" class="md-nav__link">
    <span class="md-ellipsis">
      Example usage
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  
  


  <h1>CNN</h1>

<h2 id="class-cnn">class CNN</h2>
<p>Find duplicates using CNN and/or generate CNN encodings given a single image or a directory of images.</p>
<p>The module can be used for 2 purposes: Encoding generation and duplicate detection.</p>
<ul>
<li>
<p>Encodings generation: To propagate an image through a Convolutional Neural Network architecture and generate encodings. The generated encodings can be used at a later time for deduplication. Using the method 'encode_image', the CNN encodings for a single image can be obtained while the 'encode_images' method can be used to get encodings for all images in a directory.</p>
</li>
<li>
<p>Duplicate detection: Find duplicates either using the encoding mapping generated previously using 'encode_images' or using a Path to the directory that contains the images that need to be deduplicated. 'find_duplicates' and 'find_duplicates_to_remove' methods are provided to accomplish these tasks.</p>
</li>
</ul>
<h3 id="__init__">__init__</h3>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="n">verbose</span><span class="p">,</span> <span class="n">model_config</span><span class="p">)</span>
</code></pre></div>

<p>Initialize a pytorch MobileNet model v3 that is sliced at the last convolutional layer. Set the batch size for pytorch dataloader to be 64 samples.</p>
<h5 id="args">Args</h5>
<ul>
<li>
<p><strong>verbose</strong>: Display progress bar if True else disable it. Default value is True.</p>
</li>
<li>
<p><strong>model_config</strong>: A CustomModel that can be used to initialize a custom PyTorch model along with the corresponding transform.</p>
</li>
</ul>
<h3 id="apply_preprocess">apply_preprocess</h3>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">apply_preprocess</span><span class="p">(</span><span class="n">im_arr</span><span class="p">)</span>
</code></pre></div>

<p>Apply preprocessing function for mobilenet to images.</p>
<h5 id="args_1">Args</h5>
<ul>
<li><strong>im_arr</strong>: Image typecast to numpy array.</li>
</ul>
<h5 id="returns">Returns</h5>
<ul>
<li><strong>transformed_image_tensor</strong>: Transformed images returned as a pytorch tensor.</li>
</ul>
<h3 id="encode_image">encode_image</h3>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">encode_image</span><span class="p">(</span><span class="n">image_file</span><span class="p">,</span> <span class="n">image_array</span><span class="p">)</span>
</code></pre></div>

<p>Generate CNN encoding for a single image.</p>
<h5 id="args_2">Args</h5>
<ul>
<li>
<p><strong>image_file</strong>: Path to the image file.</p>
</li>
<li>
<p><strong>image_array</strong>: Optional, used instead of image_file. Image typecast to numpy array.</p>
</li>
</ul>
<h5 id="returns_1">Returns</h5>
<ul>
<li><strong>encoding</strong>: Encodings for the image in the form of numpy array.</li>
</ul>
<h5 id="example-usage">Example usage</h5>
<div class="codehilite"><pre><span></span><code><span class="kn">from</span> <span class="nn">imagededup.methods</span> <span class="kn">import</span> <span class="n">CNN</span>
<span class="n">myencoder</span> <span class="o">=</span> <span class="n">CNN</span><span class="p">()</span>
<span class="n">encoding</span> <span class="o">=</span> <span class="n">myencoder</span><span class="o">.</span><span class="n">encode_image</span><span class="p">(</span><span class="n">image_file</span><span class="o">=</span><span class="s1">&#39;path/to/image.jpg&#39;</span><span class="p">)</span>
<span class="n">OR</span>
<span class="n">encoding</span> <span class="o">=</span> <span class="n">myencoder</span><span class="o">.</span><span class="n">encode_image</span><span class="p">(</span><span class="n">image_array</span><span class="o">=&lt;</span><span class="n">numpy</span> <span class="n">array</span> <span class="n">of</span> <span class="n">image</span><span class="o">&gt;</span><span class="p">)</span>
</code></pre></div>

<h3 id="encode_images">encode_images</h3>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">encode_images</span><span class="p">(</span><span class="n">image_dir</span><span class="p">,</span> <span class="n">recursive</span><span class="p">,</span> <span class="n">num_enc_workers</span><span class="p">)</span>
</code></pre></div>

<p>Generate CNN encodings for all images in a given directory of images. Test.</p>
<h5 id="args_3">Args</h5>
<ul>
<li>
<p><strong>image_dir</strong>: Path to the image directory.</p>
</li>
<li>
<p><strong>recursive</strong>: Optional, find images recursively in a nested image directory structure, set to False by default.</p>
</li>
<li>
<p><strong>num_enc_workers</strong>: Optional, number of cpu cores to use for multiprocessing encoding generation (supported only on linux platform), set to 0 by default. 0 disables multiprocessing.</p>
</li>
</ul>
<h5 id="returns_2">Returns</h5>
<ul>
<li><strong>dictionary</strong>: Contains a mapping of filenames and corresponding numpy array of CNN encodings.</li>
</ul>
<h5 id="example-usage_1">Example usage</h5>
<div class="codehilite"><pre><span></span><code><span class="kn">from</span> <span class="nn">imagededup.methods</span> <span class="kn">import</span> <span class="n">CNN</span>
<span class="n">myencoder</span> <span class="o">=</span> <span class="n">CNN</span><span class="p">()</span>
<span class="n">encoding_map</span> <span class="o">=</span> <span class="n">myencoder</span><span class="o">.</span><span class="n">encode_images</span><span class="p">(</span><span class="n">image_dir</span><span class="o">=</span><span class="s1">&#39;path/to/image/directory&#39;</span><span class="p">)</span>
</code></pre></div>

<h3 id="find_duplicates">find_duplicates</h3>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">find_duplicates</span><span class="p">(</span><span class="n">image_dir</span><span class="p">,</span> <span class="n">encoding_map</span><span class="p">,</span> <span class="n">min_similarity_threshold</span><span class="p">,</span> <span class="n">scores</span><span class="p">,</span> <span class="n">outfile</span><span class="p">,</span> <span class="n">recursive</span><span class="p">,</span> <span class="n">num_enc_workers</span><span class="p">,</span> <span class="n">num_sim_workers</span><span class="p">)</span>
</code></pre></div>

<p>Find duplicates for each file. Take in path of the directory or encoding dictionary in which duplicates are to be detected above the given threshold. Return dictionary containing key as filename and value as a list of duplicate file names. Optionally, the cosine distances could be returned instead of just duplicate filenames for each query file.</p>
<h5 id="args_4">Args</h5>
<ul>
<li>
<p><strong>image_dir</strong>: Path to the directory containing all the images or dictionary with keys as file names</p>
</li>
<li>
<p><strong>encoding_map</strong>: Optional, used instead of image_dir, a dictionary containing mapping of filenames and
              corresponding CNN encodings.</p>
</li>
<li>
<p><strong>min_similarity_threshold</strong>: Optional, threshold value (must be float between -1.0 and 1.0). Default is 0.9</p>
</li>
<li>
<p><strong>scores</strong>: Optional, boolean indicating whether similarity scores are to be returned along with retrieved
        duplicates.</p>
</li>
<li>
<p><strong>outfile</strong>: Optional, name of the file to save the results, must be a json. Default is None.</p>
</li>
<li>
<p><strong>recursive</strong>: Optional, find images recursively in a nested image directory structure, set to False by default.</p>
</li>
<li>
<p><strong>num_enc_workers</strong>: Optional, number of cpu cores to use for multiprocessing encoding generation (supported only on linux platform), set to 0 by default. 0 disables multiprocessing.</p>
</li>
<li>
<p><strong>num_sim_workers</strong>: Optional, number of cpu cores to use for multiprocessing similarity computation, set to number of CPUs in the system by default. 0 disables multiprocessing.</p>
</li>
</ul>
<h5 id="returns_3">Returns</h5>
<ul>
<li><strong>dictionary</strong>:  if scores is True, then a dictionary of the form {'image1.jpg': [('image1_duplicate1.jpg',
            score), ('image1_duplicate2.jpg', score)], 'image2.jpg': [] ..}. if scores is False, then a
            dictionary of the form {'image1.jpg': ['image1_duplicate1.jpg', 'image1_duplicate2.jpg'],
            'image2.jpg':['image1_duplicate1.jpg',..], ..}</li>
</ul>
<h5 id="example-usage_2">Example usage</h5>
<div class="codehilite"><pre><span></span><code><span class="kn">from</span> <span class="nn">imagededup.methods</span> <span class="kn">import</span> <span class="n">CNN</span>
<span class="n">myencoder</span> <span class="o">=</span> <span class="n">CNN</span><span class="p">()</span>
<span class="n">duplicates</span> <span class="o">=</span> <span class="n">myencoder</span><span class="o">.</span><span class="n">find_duplicates</span><span class="p">(</span><span class="n">image_dir</span><span class="o">=</span><span class="s1">&#39;path/to/directory&#39;</span><span class="p">,</span> <span class="n">min_similarity_threshold</span><span class="o">=</span><span class="mf">0.85</span><span class="p">,</span> <span class="n">scores</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="n">outfile</span><span class="o">=</span><span class="s1">&#39;results.json&#39;</span><span class="p">)</span>

<span class="n">OR</span>

<span class="kn">from</span> <span class="nn">imagededup.methods</span> <span class="kn">import</span> <span class="n">CNN</span>
<span class="n">myencoder</span> <span class="o">=</span> <span class="n">CNN</span><span class="p">()</span>
<span class="n">duplicates</span> <span class="o">=</span> <span class="n">myencoder</span><span class="o">.</span><span class="n">find_duplicates</span><span class="p">(</span><span class="n">encoding_map</span><span class="o">=&lt;</span><span class="n">mapping</span> <span class="n">filename</span> <span class="n">to</span> <span class="n">cnn</span> <span class="n">encodings</span><span class="o">&gt;</span><span class="p">,</span>
<span class="n">min_similarity_threshold</span><span class="o">=</span><span class="mf">0.85</span><span class="p">,</span> <span class="n">scores</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">outfile</span><span class="o">=</span><span class="s1">&#39;results.json&#39;</span><span class="p">)</span>
</code></pre></div>

<h3 id="find_duplicates_to_remove">find_duplicates_to_remove</h3>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">find_duplicates_to_remove</span><span class="p">(</span><span class="n">image_dir</span><span class="p">,</span> <span class="n">encoding_map</span><span class="p">,</span> <span class="n">min_similarity_threshold</span><span class="p">,</span> <span class="n">outfile</span><span class="p">,</span> <span class="n">recursive</span><span class="p">,</span> <span class="n">num_enc_workers</span><span class="p">,</span> <span class="n">num_sim_workers</span><span class="p">)</span>
</code></pre></div>

<p>Give out a list of image file names to remove based on the similarity threshold. Does not remove the mentioned files.</p>
<h5 id="args_5">Args</h5>
<ul>
<li>
<p><strong>image_dir</strong>: Path to the directory containing all the images or dictionary with keys as file names
           and values as numpy arrays which represent the CNN encoding for the key image file.</p>
</li>
<li>
<p><strong>encoding_map</strong>: Optional, used instead of image_dir, a dictionary containing mapping of filenames and
              corresponding CNN encodings.</p>
</li>
<li>
<p><strong>min_similarity_threshold</strong>: Optional, threshold value (must be float between -1.0 and 1.0). Default is 0.9</p>
</li>
<li>
<p><strong>outfile</strong>: Optional, name of the file to save the results, must be a json. Default is None.</p>
</li>
<li>
<p><strong>recursive</strong>: Optional, find images recursively in a nested image directory structure, set to False by default.</p>
</li>
<li>
<p><strong>num_enc_workers</strong>: Optional, number of cpu cores to use for multiprocessing encoding generation (supported only on linux platform), set to 0 by default. 0 disables multiprocessing.</p>
</li>
<li>
<p><strong>num_sim_workers</strong>: Optional, number of cpu cores to use for multiprocessing similarity computation, set to number of CPUs in the system by default. 0 disables multiprocessing.</p>
</li>
</ul>
<h5 id="returns_4">Returns</h5>
<ul>
<li><strong>duplicates</strong>: List of image file names that should be removed.</li>
</ul>
<h5 id="example-usage_3">Example usage</h5>
<div class="codehilite"><pre><span></span><code><span class="kn">from</span> <span class="nn">imagededup.methods</span> <span class="kn">import</span> <span class="n">CNN</span>
<span class="n">myencoder</span> <span class="o">=</span> <span class="n">CNN</span><span class="p">()</span>
<span class="n">duplicates</span> <span class="o">=</span> <span class="n">myencoder</span><span class="o">.</span><span class="n">find_duplicates_to_remove</span><span class="p">(</span><span class="n">image_dir</span><span class="o">=</span><span class="s1">&#39;path/to/images/directory&#39;</span><span class="p">),</span>
<span class="n">min_similarity_threshold</span><span class="o">=</span><span class="mf">0.85</span><span class="p">)</span>

<span class="n">OR</span>

<span class="kn">from</span> <span class="nn">imagededup.methods</span> <span class="kn">import</span> <span class="n">CNN</span>
<span class="n">myencoder</span> <span class="o">=</span> <span class="n">CNN</span><span class="p">()</span>
<span class="n">duplicates</span> <span class="o">=</span> <span class="n">myencoder</span><span class="o">.</span><span class="n">find_duplicates_to_remove</span><span class="p">(</span><span class="n">encoding_map</span><span class="o">=&lt;</span><span class="n">mapping</span> <span class="n">filename</span> <span class="n">to</span> <span class="n">cnn</span> <span class="n">encodings</span><span class="o">&gt;</span><span class="p">,</span>
<span class="n">min_similarity_threshold</span><span class="o">=</span><span class="mf">0.85</span><span class="p">,</span> <span class="n">outfile</span><span class="o">=</span><span class="s1">&#39;results.json&#39;</span><span class="p">)</span>
</code></pre></div>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "../..", "features": [], "search": "../../assets/javascripts/workers/search.d50fe291.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../assets/javascripts/bundle.13a4f30d.min.js"></script>
      
    
  </body>
</html>